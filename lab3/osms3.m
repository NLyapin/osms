% Определение частотных значений
f1 = 12;
f2 = 12 + 4;
f3 = 12 * 2 + 1;

% Генерация временной оси
t = (0:99) / 100;

% Построение сигналов для каждой частоты
s1 = cos(2 * pi * f1 * t); % Сигнал с частотой f1
s2 = cos(2 * pi * f2 * t); % Сигнал с частотой f2
s3 = cos(2 * pi * f3 * t); % Сигнал с частотой f3

% Формирование итоговых сигналов
a = 4 * s1 + 3 * s2 + s3; % Комбинированный сигнал a
b = 2 * s1 + s2;          % Комбинированный сигнал b

% Расчет корреляций
corr1 = sum(a .* b);        % Корреляция между a и b
corr2 = sum(s1 .* a);       % Корреляция между s1 и a
corr3 = sum(s1 .* b);       % Корреляция между s1 и b

% Расчет сумм квадратов
sum_a = sum(a .* a);
sum_b = sum(b .* b);
sum_s1 = sum(s1 .* s1);

% Нормализация корреляций
corr_norm1 = corr1 / sqrt(sum_a * sum_b); % Нормализованная корреляция a и b
corr_norm2 = corr2 / sqrt(sum_s1 * sum_a); % Нормализованная корреляция s1 и a
corr_norm3 = corr3 / sqrt(sum_s1 * sum_b); % Нормализованная корреляция s1 и b

% Вывод результатов
fprintf("Результат корреляции между сигналами a и b: %f\n", corr1);
fprintf("Корреляция сигнала s1 с сигналом a: %f\n", corr2);
fprintf("Корреляция сигнала s1 с сигналом b: %f\n", corr3);
fprintf("Нормализованная корреляция a и b: %f\n", corr_norm1);
fprintf("Нормализованная корреляция s1 и a: %f\n", corr_norm2);
fprintf("Нормализованная корреляция s1 и b: %f\n", corr_norm3);

% Пример с временными рядами
a1 = [0.3, 0.2, -0.1, 4.2, -2, 1.5, 0];  % Исходный сигнал a1
b1 = [0.3, 4, -2.2, 1.6, 0.1, 0.1, 0.2]; % Исходный сигнал b1

% Временная ось для сигналов
t1 = 0:length(a1) - 1;

% Массив для хранения значений корреляций при сдвигах
correlat = zeros(1, length(a1));

% Цикл по сдвигам и расчет корреляций
for i = 1:length(a1)
    data_shifted = circshift(b1, i - 1); % Сдвиг b1
    correlat(i) = sum(a1 .* data_shifted); % Корреляция при данном сдвиге
end

% Поиск максимального значения корреляции
[~, max_corr_idx] = max(correlat); 
b_max = circshift(b1, max_corr_idx - 1); % Сдвиг b1 для максимальной корреляции

% Построение графиков
figure;
subplot(3, 1, 1);
plot(t1, a1);
title('Исходный сигнал a1');

subplot(3, 1, 2);
plot(t1, b1);
title('Исходный сигнал b1');

subplot(3, 1, 3);
plot(t1, b_max);
title('Сигнал b1 с максимальной корреляцией');

% График корреляций при разных сдвигах
figure;
plot(t1, correlat);
title('Корреляция при различных сдвигах');
xlabel('Сдвиг');
ylabel('Значение корреляции');

% Вывод значений корреляций
disp("Значения корреляций при различных сдвигах:");
disp(correlat);
